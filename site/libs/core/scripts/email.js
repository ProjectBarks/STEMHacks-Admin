var serialized_cache="";require(["toastr","jquery"],function(e){$(document).ready(function(){$.ajax({type:"POST",crossDomain:!0,dataType:"json",url:"/email/types",success:function(e){for(var r=$("#email_type"),a=0;a<e.length;a++)r.append("<option>"+e[a]+"</option>")},error:function(){$("#email_type").append("<option>Error</option>"),e.error("Failed to load types!")}})}),$("#email_reset_button").click(function(){$("#email_preview").html("")}),$("#email_buttons").click(function(){var r=$("#email_form");$.ajax({type:"POST",crossDomain:!0,dataType:"json",url:"/email/send",data:r.serialize(),success:function(r){return"complete"!=r.result?void e.warning("Error: "+r.result):void e.success("Email Sent!")},error:function(r,a){e.error("Error Code: "+a),console.log(r.responseText)}}),$("#email_preview").html(""),r.find("input, textarea").val("")}),$("#email_form").change(function(){var e=$(this).serialize();serialized_cache!=e&&(serialized_cache=e,$.ajax({type:"POST",crossDomain:!0,dataType:"json",url:"/email/generate",data:e,success:function(e){var r=e.email.split("\n"),a=$("#email_preview");a.html("");for(var i=0;i<r.length;i++)a.append("<p>"+r[i]+"</p>")},error:function(){var e=$("#email_preview");e.html(""),e.append("<p>Error<p>")}}))})});